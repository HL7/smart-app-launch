resourceType: StructureDefinition
id: patient-access-brand
url: 'http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-brand'
name: PatientAccessBrand
title: Patient Access Brand (Organization) Profile
status: active
date: '2023-03-05'
description: >-
  Profile on Organization to communicate the branding associated with a Patient

  Access API endpoint.


  * Extensions about the **Brand**
      * `0..* MS` Logo
          * `url` is `http://hl7.org/fhir/smart-app-launch/StructureDefinition/brand-logo`
          * `valueUrl` SHOULD be optimized for display as a 1" square and formatted as SVG or 1024x1024 pixel PNG with transparent background. Logo should be be legible at small sizes (e.g., as small as 50x50 pixels). Tips to achieve this: if the logo contains both a brandmark and a wordmark, separate them and use just the brandmark. If the logo is predominantly horizontal, consider creating a vertically-oriented logo that is still recognizable when scaled to smaller sizes. Multiple logos may be supplied. The URL can be an absolute URL  with the `https://` schema, or a [Data URL](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs) with the `data:` schema that directly embeds content.
      * `0..1 MS` Logo use agreement
          *  `url` is `http://hl7.org/fhir/smart-app-launch/StructureDefinition/brand-logo-use-agreement-agreement`.
          *  `valueUrl` MAY include a link to terms for logo use by patient access apps.
      * `0..*` Brand flags
          * `url` is `http://hl7.org/fhir/smart-app-launch/StructureDefinition/brand-flags`.
        * This flag is intended to help app developers understand and debug the organizational relationships that underpin published Brands. For example, a `valueCode` of `hidden` allows systems to designate Organizations as part of a hierarchy without necessarily being shown in a UX card or tile.  Marking Brands `hidden` can also be used to associate many affiliated organizations with a parent Brand (e.g., each with its street address) without apps displaying redundant information to users.
  * Extensions about the Brand's **Patient Access** ("portal"). These extensions
  represent the "Patient Access Details" described in the conceptual model
  above. These extensions are "**inheritable**", which means Brand entries in
  the Brand Bundle systems MAY be omit these extension whenever correct values
  are inferrable by following the entry's "Patient access provided by" links
  (`Organization.partOf`).
      * `0..1 MS` Patient access name ("portal name") Note: A Brand MUST include a this extension or inherit the value from the Brand referenced by `Organization.partOf`.
          * `url` is `http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-name`.
          * `valueString` indicates the name by which patients know the portal (e.g.,"MyChildren" or "Patient Gateway") 
      * `0..1 MS` Patient access URL ("portal URL") Note: A Brand MUST include a this extension or inherit the value from the Brand referenced by `Organization.partOf`.
          * `url` is `http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-url`.
          * `valueUrl` indicates the location of the patient portal associated with this Brand -- i.e., a URL where patients can go to see their data and manage access.
      * `0..1 MS` Patient access description ("portal description")
          * `url` is  `http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-description`.
          * `valueMarkdown` explains, if necessary (in patient-friendly language), the subset of patients eligible to connect and the data available. This capability supports (for example) a cancer center that uses one EHR for pediatric patients and another for adult patients. In this scenario, each EHR would publish a different `PatientAccessBrand`; apps would display the description to disambiguate the user's selection. For instance, one Brand might indicate "Access records for childhood cancer care" and another might indicate "Access records for adult cancer care".
      * `0..* MS` Patient access logo ("portal logo"). Used if the portal has its own logo in addition to the Brand's logo
          * `url` is `http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-logo`
          * `valueUrl` See documentation for "brand logo"
      * `0..1 MS` Patient access logo use agreement
          *  `url` is `http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-logo-use-agreement`.
          *  `valueUrl` See documentation for "brand logo use agreement".
  * `0..* MS` `identifier`(s) that apps can use to link this Brand across
  publishers or with external data sets. EHRs SHALL support customer-supplied
  identifiers (`system` and `value`).
      * It is RECOMMENDED that each Brand include an identifier where `system` is `urn:ietf:rfc: 3986` (meaning the identifier is a URL) and `value` is the HTTPS URL for the Brand's primary web presence, omitting any "www." prefix from the domain and omitting any path component. For example, since the main web presence of Boston Children's Hospital is https: //www.childrenshospital.org/, a recommended identifier would be:

       `{
       "system": "urn:ietf:rfc:3986",
       "value": "https://childrenshospital.org"
        }`

  * `0..*` `type` Categories for this organization (system:
  `http://hl7.org/fhir/smart-app-launch/CodeSystem/patient-access-category`,
  code from: `clinical`, `lab`, `pharmacy`, `insurer`, `network`, `aggregator`)

  * `1..1 MS` `name` Primary brand name to display on a card

  * `0..* MS` `alias` Aliases (e.g., former names like "Partners Healthcare")
  for filtering/search

  * `1..1 MS` `telecom` with `system` of `url` and `value` conveying the primary
  public website for the Brand. Note this is distinct from the patient access
  portal website (described below)

  * `0..* MS` `address` Locations (e.g., zip codes and/or street addresses)
  associated with the Brand. The following combinations are allowed:
    * State
    * City, state
    * City, state, zip code
    * Street address, city, state, zip code
    * zip code alone
  * `0..1 MS` `partOf` "Patient access provided by", to convey that an
    affiliated Brand hosts this Brand's API technology and patient portal. The
    hierarchy of "access provided by" links SHALL NOT exceed a depth of two (i.e.,
    a Brand either includes portal details or links directly to a Brand that
    provides them).
  * `0..* MS` `endpoint` references one or more `PatientAccessEndpoints`.  Typically, this
    property associates a single "primary brand" with the endpoint. Additional
    affiliated Brands or parent brands can be associated via "Patient access
    provided by" links (`Organization.partOf`). EHR vendors SHALL support
    integrated publication of Organizations in the same JSON Bundle, as well as
    external customer-managed publications:
    
        # * `0..* MS` `extension` with

        #    * `url`
        #      `http://hl7.org/fhir/smart-app-launch/StructureDefinition/brands-bundle`

        #     * `valueUrl` URL for a customer-managed Patient Access Brands Bundle
        #        that defines the identified Brand and related Brands (the Bundle SHALL
        #        contain exactly one entry matching the specified identifier). This extension
        #        allows customers to self-publish additional information about the Brand.

        * `0..1 MS`  `reference` containing a relative URL to an Endpoint within a Brand Bundle

        # * `0..1 MS` `identifier` with a customer-supplied identifier for the
        #    primary Endpoint


fhirVersion: 4.0.1
kind: resource
abstract: false
type: Organization
baseDefinition: 'http://hl7.org/fhir/StructureDefinition/Organization'
derivation: constraint
differential:
  element:
    - id: Organization
      path: Organization
      short: Patient Access Brand
      definition: >-
        A brand of a healthcare provider, such as a hospital, clinic, or
        practice
      constraint:
        - key: pab-1
          severity: error
          human: >-
            A Patient Access Brand SHALL have a *portalName* extension or a
            reference to  an affiliated "parent brand" (`Organization.partOf`)
            or both.
          expression: >-
            extension.where(url='http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-name').exists()
            or partOf.exists()
        - key: pab-2
          severity: error
          human: >-
            A Patient Access Brand SHALL have a *portalURL* extension or a
            reference to  an affiliated "parent brand" (`Organization.partOf`)
            or both.
          expression: >-
            extension.where(url='http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-name').exists()
            or partOf.exists()
    - id: 'Organization.extension:logo'
      path: Organization.extension
      sliceName: logo
      short: Patient Access Brand Logo
      min: 0
      max: '*'
      type:
        - code: Extension
          profile:
            - >-
              http://hl7.org/fhir/smart-app-launch/StructureDefinition/brand-logo
      mustSupport: true
    - id: 'Organization.extension:logoUse'
      path: Organization.extension
      sliceName: logoUse
      short: Patient Access Brand Logo Use Agreement
      min: 0
      max: '1'
      type:
        - code: Extension
          profile:
            - >-
              http://hl7.org/fhir/smart-app-launch/StructureDefinition/brand-logo-use-agreement
      mustSupport: true
    - id: 'Organization.extension:flags'
      path: Organization.extension
      sliceName: flags
      short: Patient Access Brand Flags
      min: 0
      max: '*'
      type:
        - code: Extension
          profile:
            - >-
              http://hl7.org/fhir/smart-app-launch/StructureDefinition/brand-flags
      mustSupport: true
    - id: 'Organization.extension:portalName'
      path: Organization.extension
      sliceName: portalName
      short: Patient Access Brand Portal Name
      min: 0
      max: '1'
      type:
        - code: Extension
          profile:
            - >-
              http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-name
      condition:
        - pab-1
      mustSupport: true
    - id: 'Organization.extension:portalURL'
      path: Organization.extension
      sliceName: portalURL
      short: Patient Access Brand Portal URL
      min: 0
      max: '1'
      type:
        - code: Extension
          profile:
            - >-
              http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-url
      mustSupport: true
    - id: 'Organization.extension:portalDescription'
      path: Organization.extension
      sliceName: portalDescription
      short: Patient Access Brand Portal Description
      min: 0
      max: '1'
      type:
        - code: Extension
          profile:
            - >-
              http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-description
      condition:
        - pab-2
      mustSupport: true
    - id: 'Organization.extension:portalLogo'
      path: Organization.extension
      sliceName: portalLogo
      short: Patient Access Brand Portal Logo
      min: 0
      max: '*'
      type:
        - code: Extension
          profile:
            - >-
              http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-logo
      mustSupport: true
    - id: 'Organization.extension:portalLogoUse'
      path: Organization.extension
      sliceName: portalLogoUse
      short: Patient Access Brand Portal Logo Use Agreement
      min: 0
      max: '1'
      type:
        - code: Extension
          profile:
            - >-
              http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-logo-use-agreement
      mustSupport: true
    - id: Organization.identifier
      path: Organization.identifier
      short: Unique identifier for the brand
      definition: >
        The unique identifier for the brand  that apps can use to link this
        Brand across publishers or with external data sets. EHRs SHALL support
        customer-supplied identifiers (`system` and `value`).


        * It is RECOMMENDED that each Brand include an identifier where `system`
        is `urn:ietf:rfc: 3986` (meaning the identifier is a URL) and `value` is
        the HTTPS URL for the Brand's primary web presence, omitting any "www."
        prefix from the domain and omitting any path component. For example,
        since the main web presence of Boston Children's Hospital is
        https: //www.childrenshospital.org/, a recommended identifier would be:

          `{
            "system": "urn:ietf:rfc:3986",
            "value": "https://childrenshospital.org"
           }`
      mustSupport: true
    - id: Organization.type
      path: Organization.type
      short: >-
        Categories for this organization (health-system, hospital, outpatient,
        insurer, lab, pharmacy)
      definition: >-
        Categories for this organization (system:
        `http://hl7.org/fhir/smart-app-launch/CodeSystem/patient-access-category`,
        code from: `clinical`, `lab`, `pharmacy`, `insurer`, `network`,
        `aggregator`)
      binding:
        strength: extensible
        valueSet: 'http://hl7.org/fhir/smart-app-launch/ValueSet/patient-access-category'
    - id: Organization.name
      path: Organization.name
      short: Primary brand name to display on a card
      definition: The primary brand name to display on a card.
      min: 1
      mustSupport: true
    - id: Organization.alias
      path: Organization.alias
      short: >-
        Aliases (e.g., former names like "Partners Healthcare") for
        filtering/search
      definition: >-
        Aliases (e.g., former names like "Partners Healthcare") for
        filtering/search
      mustSupport: true


    - id: Organization.telecom
      path: Organization.telecom
      short: The primary public website for the Brand.
      definition: >-
        `telecom` with `system` of `url` and `value` conveying the primary
        public website for the Brand. Note this is distinct from the patient
        access portal website.
      min: 1
      max: '1'
      mustSupport: true
    - id: Organization.address
      path: Organization.address
      short: >-
        Locations (e.g., zip codes and/or street addresses) associated with the
        Brand.
      definition: >
        Locations (e.g., zip codes and/or street addresses) associated with the
        Brand. The following combinations are allowed:
          * State
          * City, state
          * City, state, zip code
          * Street address, city, state, zip code
          * zip code alone
      mustSupport: true
    - id: Organization.partOf
      path: Organization.partOf
      short: >-
        Affiliated "parent brand", if this Brand is part of a larger health
        system
      definition: >-
        Affiliated "parent brand", if this Brand is part of a larger health
        system.  "Patient access provided by", to convey that an affiliated
        Brand hosts this Brand's API technology and patient portal. The
        hierarchy of "access provided by" links SHALL NOT exceed a depth of two
        (i.e., a Brand either includes portal details or links directly to a
        Brand that provides them).
      condition:
        - pab-1
        - pab-2
      mustSupport: true

    - id: Organization.endpoint
      path: Organization.endpoint
      short: The "primary brand" endpoint.
      definition: >-
        References one or more `PatientAccessEndpoints`.  Typically, this
        property associates a single "primary brand" with the endpoint. Additional
        affiliated Brands or parent brands can be associated via "Patient access
        provided by" links (`Organization.partOf`). EHR vendors SHALL support
        integrated publication of Organizations in the same JSON Bundle, as well as
        external customer-managed publications:
      min: 1

      type:
        - code: Reference
          targetProfile:
            - >-
              http://hl7.org/fhir/smart-app-launch/StructureDefinition/patient-access-endpoint
          aggregation:
            - bundled
      # constraint:
      #   - key: pae-1
      #     severity: error
      #     human: >-
      #       A Patient Access Organization Endpoint SHALL have both or
      #       neither an `identifier` and a "endpoint-bundle" extension.
      #     expression: >-
      #       (identifier.exists() xor
      #       extension.where(url='http://hl7.org/fhir/smart-app-launch/StructureDefinition/endpoint-bundle').exists()).not()
      mustSupport: true


    # - id: 'Endpoint.managingOrganization.extension:endpoint-bundle'
    #   path: Endpoint.managingOrganization.extension
    #   sliceName: endpoint-bundle
    #   short: URL for a customer-managed Patient Access Brands Bundle
    #   definition: >-
    #     URL for a customer-managed Patient Access Brands Bundle that defines the
    #     identified  and related Brands (the Bundle SHALL contain exactly
    #     one entry matching the specified identifier).
    #   type:
    #     - code: Extension
    #       profile:
    #         - >-
    #           http://hl7.org/fhir/smart-app-launch/StructureDefinition/endpoint-bundle
    #   condition:
    #     - pae-1
    #   mustSupport: true




    - id: 'Organization.endpoint.reference'
      path: Organization.endpoint.reference
      short: >-
        Relative URL to an Endpoint within the Patient Access Brands Bundle
      definition: >-
        Relative URL to an Endpoint within the Patient Access Brands Bundle
      min: 0
      max: '1'
      mustSupport: true


    # - id: 'Organization.endpoint.identifier'
    #   path: Organization.endpoint.identifier
    #   short: >-
    #       Customer-supplied identifier for the primary Endpoint
    #   definition: >-
    #       Customer-supplied identifier for the primary Endpoint
    #   min: 0
    #   max: '1'
    #   condition:
    #     - pae-1
    #   mustSupport: true
